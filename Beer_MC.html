<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="MayaC" />

<meta name="date" content="2024-02-27" />

<title>Unit_8_Beer</title>

<script src="site_libs/header-attrs-2.25/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">My first website</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Welcome</a>
</li>
<li>
  <a href="CLT.html">CLT case study</a>
</li>
<li>
  <a href="Beer_MC.html">Beer &amp; Breweries case study</a>
</li>
<li>
  <a href="Project_2_MC.html">Attrition case study</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Unit_8_Beer</h1>
<h4 class="author">MayaC</h4>
<h4 class="date">2024-02-27</h4>

</div>


<div id="r-markdown" class="section level2">
<h2>R Markdown</h2>
<p>This is an R Markdown document. Markdown is a simple formatting
syntax for authoring HTML, PDF, and MS Word documents. For more details
on using R Markdown see <a href="http://rmarkdown.rstudio.com"
class="uri">http://rmarkdown.rstudio.com</a>.</p>
<p>When you click the <strong>Knit</strong> button a document will be
generated that includes both content as well as the output of any
embedded R code chunks within the document. You can embed an R code
chunk like this:</p>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
## ✔ dplyr     1.1.4     ✔ readr     2.1.4
## ✔ forcats   1.0.0     ✔ stringr   1.5.1
## ✔ ggplot2   3.4.4     ✔ tibble    3.2.1
## ✔ lubridate 1.9.3     ✔ tidyr     1.3.0
## ✔ purrr     1.0.2     
## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()
## ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
<pre class="r"><code>library(dplyr)
library(stringr)
library(ggplot2)
#connecting to the dataset - beer and breweries dataset provided for this project
beers &lt;- read.csv(&quot;Beers.csv&quot;, header= TRUE)
breweries &lt;- read.csv(&quot;Breweries.csv&quot;, header= TRUE)
#check data
head(beers)</code></pre>
<pre><code>##                  Name Beer_ID   ABV IBU Brewery_id
## 1            Pub Beer    1436 0.050  NA        409
## 2         Devil&#39;s Cup    2265 0.066  NA        178
## 3 Rise of the Phoenix    2264 0.071  NA        178
## 4            Sinister    2263 0.090  NA        178
## 5       Sex and Candy    2262 0.075  NA        178
## 6        Black Exodus    2261 0.077  NA        178
##                            Style Ounces
## 1            American Pale Lager     12
## 2        American Pale Ale (APA)     12
## 3                   American IPA     12
## 4 American Double / Imperial IPA     12
## 5                   American IPA     12
## 6                  Oatmeal Stout     12</code></pre>
<pre class="r"><code>head(breweries)</code></pre>
<pre><code>##   Brew_ID                      Name          City State
## 1       1        NorthGate Brewing    Minneapolis    MN
## 2       2 Against the Grain Brewery    Louisville    KY
## 3       3  Jack&#39;s Abby Craft Lagers    Framingham    MA
## 4       4 Mike Hess Brewing Company     San Diego    CA
## 5       5   Fort Point Beer Company San Francisco    CA
## 6       6     COAST Brewing Company    Charleston    SC</code></pre>
<pre class="r"><code>#create data frames to answer questions
dfbeer = data.frame(BeerName = beers$Name,Beer_ID = beers$Beer_ID,ABV= beers$ABV,IBU = beers$IBU, Brew_ID = beers$Brewery_id, Style = beers$Style, Ounces = beers$Ounces)

dfbrewery = data.frame(Brew_ID = breweries$Brew_ID,BreweryName = breweries$Name,City= breweries$City,State = breweries$State)
#check data
head(dfbeer)</code></pre>
<pre><code>##              BeerName Beer_ID   ABV IBU Brew_ID                          Style
## 1            Pub Beer    1436 0.050  NA     409            American Pale Lager
## 2         Devil&#39;s Cup    2265 0.066  NA     178        American Pale Ale (APA)
## 3 Rise of the Phoenix    2264 0.071  NA     178                   American IPA
## 4            Sinister    2263 0.090  NA     178 American Double / Imperial IPA
## 5       Sex and Candy    2262 0.075  NA     178                   American IPA
## 6        Black Exodus    2261 0.077  NA     178                  Oatmeal Stout
##   Ounces
## 1     12
## 2     12
## 3     12
## 4     12
## 5     12
## 6     12</code></pre>
<pre class="r"><code>head(dfbrewery)</code></pre>
<pre><code>##   Brew_ID               BreweryName          City State
## 1       1        NorthGate Brewing    Minneapolis    MN
## 2       2 Against the Grain Brewery    Louisville    KY
## 3       3  Jack&#39;s Abby Craft Lagers    Framingham    MA
## 4       4 Mike Hess Brewing Company     San Diego    CA
## 5       5   Fort Point Beer Company San Francisco    CA
## 6       6     COAST Brewing Company    Charleston    SC</code></pre>
<pre class="r"><code>#merge datasets -
dfcombined &lt;- merge(dfbeer,dfbrewery,&quot;Brew_ID&quot;)

#check data
head(dfcombined)</code></pre>
<pre><code>##   Brew_ID      BeerName Beer_ID   ABV IBU                               Style
## 1       1  Get Together    2692 0.045  50                        American IPA
## 2       1 Maggie&#39;s Leap    2691 0.049  26                  Milk / Sweet Stout
## 3       1    Wall&#39;s End    2690 0.048  19                   English Brown Ale
## 4       1       Pumpion    2689 0.060  38                         Pumpkin Ale
## 5       1    Stronghold    2688 0.060  25                     American Porter
## 6       1   Parapet ESB    2687 0.056  47 Extra Special / Strong Bitter (ESB)
##   Ounces        BreweryName        City State
## 1     16 NorthGate Brewing  Minneapolis    MN
## 2     16 NorthGate Brewing  Minneapolis    MN
## 3     16 NorthGate Brewing  Minneapolis    MN
## 4     16 NorthGate Brewing  Minneapolis    MN
## 5     16 NorthGate Brewing  Minneapolis    MN
## 6     16 NorthGate Brewing  Minneapolis    MN</code></pre>
<pre class="r"><code>#Question 1 - How many breweries are present in each state?
# Create a bar plot showing the count of breweries in each state
library(ggplot2)
ggplot(dfbrewery, aes(x = State)) +
  geom_bar() +
  labs(x = &quot;State&quot;, y = &quot;Number of Breweries&quot;, title = &quot;Number of Breweries in Each State&quot;)</code></pre>
<p><img src="Beer_MC_files/figure-html/unnamed-chunk-1-1.png" width="960" /></p>
<pre class="r"><code>#Question 2 Merge beer data with the breweries data. Print the first 6 observations and the last six observations to check the merged file.  
#first 6 observations
first_6_rows &lt;- head(dfcombined,6)
print(first_6_rows)</code></pre>
<pre><code>##   Brew_ID      BeerName Beer_ID   ABV IBU                               Style
## 1       1  Get Together    2692 0.045  50                        American IPA
## 2       1 Maggie&#39;s Leap    2691 0.049  26                  Milk / Sweet Stout
## 3       1    Wall&#39;s End    2690 0.048  19                   English Brown Ale
## 4       1       Pumpion    2689 0.060  38                         Pumpkin Ale
## 5       1    Stronghold    2688 0.060  25                     American Porter
## 6       1   Parapet ESB    2687 0.056  47 Extra Special / Strong Bitter (ESB)
##   Ounces        BreweryName        City State
## 1     16 NorthGate Brewing  Minneapolis    MN
## 2     16 NorthGate Brewing  Minneapolis    MN
## 3     16 NorthGate Brewing  Minneapolis    MN
## 4     16 NorthGate Brewing  Minneapolis    MN
## 5     16 NorthGate Brewing  Minneapolis    MN
## 6     16 NorthGate Brewing  Minneapolis    MN</code></pre>
<pre class="r"><code>#last 6 observations
last_6_rows &lt;- dfcombined[(nrow(dfcombined) - 5):nrow(dfcombined), ]
print(last_6_rows)</code></pre>
<pre><code>##      Brew_ID                  BeerName Beer_ID   ABV IBU
## 2405     556             Pilsner Ukiah      98 0.055  NA
## 2406     557  Heinnieweisse Weissebier      52 0.049  NA
## 2407     557           Snapperhead IPA      51 0.068  NA
## 2408     557         Moo Thunder Stout      50 0.049  NA
## 2409     557         Porkslap Pale Ale      49 0.043  NA
## 2410     558 Urban Wilderness Pale Ale      30 0.049  NA
##                        Style Ounces                   BreweryName          City
## 2405         German Pilsener     12         Ukiah Brewing Company         Ukiah
## 2406              Hefeweizen     12       Butternuts Beer and Ale Garrattsville
## 2407            American IPA     12       Butternuts Beer and Ale Garrattsville
## 2408      Milk / Sweet Stout     12       Butternuts Beer and Ale Garrattsville
## 2409 American Pale Ale (APA)     12       Butternuts Beer and Ale Garrattsville
## 2410        English Pale Ale     12 Sleeping Lady Brewing Company     Anchorage
##      State
## 2405    CA
## 2406    NY
## 2407    NY
## 2408    NY
## 2409    NY
## 2410    AK</code></pre>
<pre class="r"><code>#managing missing values - ABV values are missing for 62 of the 2,405 rows and IBU values are missing for 1,005 of 2,410 rows. The ABV values look like there are missing completely at random. While I can&#39;t find any evidence of &quot;missing at random&quot; or &quot;not missing at random&quot; for IBU values, my gut says I am not looking at all the angles. I made a called to calculate the mean and populate the missing data with mean values. This has been done for both ABV and IBU. All the below questions are answered based on this dataset.
# calculate mean for both variables at the Style level
library(dplyr)

dfcombined_Mean &lt;- dfcombined %&gt;%
  group_by(Style) %&gt;%
  summarise(mean_ABV = mean(ABV, na.rm = TRUE),
            mean_IBU = mean(IBU, na.rm = TRUE))
#populate NA values for ABV and IBU with mean values
# Merge dfcombined with dfcombined_Mean to get mean values for each style
dfcombined_updated &lt;- dfcombined %&gt;%
  left_join(dfcombined_Mean, by = &quot;Style&quot;)

# Replace NA values in ABV and IBU columns with corresponding mean values
dfcombined_updated$ABV[is.na(dfcombined_updated$ABV)] &lt;- dfcombined_updated$mean_ABV[is.na(dfcombined_updated$ABV)]
dfcombined_updated$IBU[is.na(dfcombined_updated$IBU)] &lt;- dfcombined_updated$mean_IBU[is.na(dfcombined_updated$IBU)]

# Remove unnecessary columns (mean_ABV, mean_IBU) 
dfcombined_updated &lt;- dfcombined_updated %&gt;%
  select(-mean_ABV, -mean_IBU)

# Print rows where IBU or ABV is NA
dim(dfcombined_updated %&gt;% filter(is.na(IBU) | is.na(ABV)))</code></pre>
<pre><code>## [1] 52 10</code></pre>
<pre class="r"><code># there are 52 rows where none of the IBU values for that Style was populated. Hence we couldn&#39;t replace the NA with mean values. These were removed from the dataset for the below questions.


#Question 4 - Compute the median alcohol content and international bitterness unit for each state. Plot a bar chart to compare.

# Remove NA values from ABV and IBU columns
dfcombined_clean &lt;- dfcombined[!is.na(dfcombined$ABV) &amp; !is.na(dfcombined$IBU), ]
dfcombined_updated_clean &lt;- dfcombined_updated[!is.na(dfcombined_updated$ABV) &amp; !is.na(dfcombined_updated$IBU), ]

#check data
dim(dfcombined)</code></pre>
<pre><code>## [1] 2410   10</code></pre>
<pre class="r"><code>dim(dfcombined_clean)</code></pre>
<pre><code>## [1] 1405   10</code></pre>
<pre class="r"><code>dim(dfcombined_updated)</code></pre>
<pre><code>## [1] 2410   10</code></pre>
<pre class="r"><code>dim(dfcombined_updated_clean)</code></pre>
<pre><code>## [1] 2358   10</code></pre>
<pre class="r"><code># Calculate median ABV and median IBU for each state
medians_by_state &lt;- dfcombined_updated_clean %&gt;%
  group_by(State) %&gt;%
  summarise(Median_ABV = median(ABV), Median_IBU = median(IBU, na.rm = TRUE))
Overall_Median &lt;- median(medians_by_state$Median_ABV)
Overall_Median_I &lt;- median(medians_by_state$Median_IBU)

# check data
head(medians_by_state,10)</code></pre>
<pre><code>## # A tibble: 10 × 3
##    State Median_ABV Median_IBU
##    &lt;chr&gt;      &lt;dbl&gt;      &lt;dbl&gt;
##  1 &quot; AK&quot;     0.056        33.8
##  2 &quot; AL&quot;     0.06         39.5
##  3 &quot; AR&quot;     0.052        36.3
##  4 &quot; AZ&quot;     0.0575       22.2
##  5 &quot; CA&quot;     0.058        40  
##  6 &quot; CO&quot;     0.06         36.3
##  7 &quot; CT&quot;     0.06         36.3
##  8 &quot; DC&quot;     0.0625       28.1
##  9 &quot; DE&quot;     0.0598       59.8
## 10 &quot; FL&quot;     0.0555       35.6</code></pre>
<pre class="r"><code>#plot the median values
bar1 &lt;- ggplot(medians_by_state, aes(x = State, y = Median_ABV)) +  # Move aes() inside ggplot()
  geom_col(fill = &#39;blue&#39;) + 
  labs(x = &quot;State&quot;, y = &quot;Median ABV&quot;, title = &quot;Median Alcohol by Volume of Beers in Each State&quot;) +
  theme(
    plot.title = element_text(size = 20),
    axis.text.x = element_text(angle = 45, hjust = 1),
    axis.text.y = element_text(size = 12),
    axis.title = element_text(size = 14)
  ) + 
  geom_hline(yintercept = Overall_Median, color = &quot;red&quot;)  # Add a horizontal line for overall median
  
bar2 = ggplot(medians_by_state, aes(x = State, y = Median_IBU)) +
  geom_col(fill = &#39;green&#39;) + 
  labs(x = &quot;State&quot;, y = &quot;Median IBU&quot;, title = &quot;Median International Bitterness Unit of Beers in Each State&quot;) +
   theme(
    plot.title = element_text(size = 20),
    axis.text.x = element_text(angle = 45, hjust = 1),
    axis.text.y = element_text(size = 12),
    axis.title = element_text(size = 14)
  ) + 
  geom_hline(yintercept = Overall_Median_I, color = &quot;red&quot;)  # Add a horizontal line for overall median

#display both plots
library(patchwork)
bar1 / bar2</code></pre>
<p><img src="Beer_MC_files/figure-html/unnamed-chunk-1-2.png" width="960" /></p>
<pre class="r"><code>#Question 5 - Which state has the maximum alcoholic (ABV) beer? Which state has the most bitter (IBU) beer?
#state with maximum alcoholic beer
max_abv &lt;- max(dfcombined_updated_clean$ABV, na.rm = TRUE) 
max_abv_index &lt;- which.max(dfcombined_updated_clean$ABV)
state_with_max_abv &lt;- dfcombined_updated_clean$State[max_abv_index]
print(state_with_max_abv)</code></pre>
<pre><code>## [1] &quot; CO&quot;</code></pre>
<pre class="r"><code>cat(&quot;State with maximum alcohol by volume beer is :&quot;,state_with_max_abv, &quot;with ABV of&quot;,max_abv,&quot;\n&quot;)</code></pre>
<pre><code>## State with maximum alcohol by volume beer is :  CO with ABV of 0.128</code></pre>
<pre class="r"><code>#state with most bitter beer
max_ibu &lt;- max(dfcombined_updated_clean$IBU,na.rm = TRUE)
max_ibu_index &lt;- which.max(dfcombined_updated_clean$IBU)
state_with_max_ibu &lt;- dfcombined_updated_clean$State[max_ibu_index]
print(state_with_max_ibu)</code></pre>
<pre><code>## [1] &quot; OR&quot;</code></pre>
<pre class="r"><code>cat(&quot;State with most bitter beer is :&quot;,state_with_max_ibu, &quot;with IBU of&quot;,max_ibu,&quot;\n&quot;)</code></pre>
<pre><code>## State with most bitter beer is :  OR with IBU of 138</code></pre>
<pre class="r"><code>#Question 6 - Comment on the summary statistics and distribution of the ABV variable.
#create a new region column
midwest &lt;- c( &quot;IA&quot;,&quot;IL&quot;, &quot;IN&quot;, &quot;KS&quot;, &quot;MI&quot;, &quot;MN&quot;, &quot;MO&quot;, &quot;ND&quot;,&quot;NE&quot;, &quot;OH&quot;, &quot;SD&quot;, &quot;WI&quot;)
northeast &lt;- c(&quot;CT&quot;,&quot;MA&quot;, &quot;ME&quot;, &quot;NH&quot;, &quot;NJ&quot;, &quot;NY&quot;, &quot;PA&quot;, &quot;RI&quot;, &quot;VT&quot;)
south &lt;- c(&quot;AL&quot;,&quot;AR&quot;,&quot;DC&quot;,&quot;DE&quot;,&quot;FL&quot;,&quot;GA&quot;,&quot;KY&quot;,&quot;LA&quot;,&quot;MD&quot;,&quot;MS&quot;,&quot;NC&quot;,&quot;OK&quot;,&quot;SC&quot;,&quot;TN&quot;,&quot;TX&quot;,&quot;VA&quot;,&quot;WV&quot;)
west &lt;- c(&quot;AK&quot;,&quot;AZ&quot;,&quot;CA&quot;,&quot;CO&quot;,&quot;HI&quot;,&quot;ID&quot;,&quot;MT&quot;,&quot;NM&quot;,&quot;NV&quot;,&quot;OR&quot;,&quot;UT&quot;,&quot;WA&quot;,&quot;WY&quot;)
 
# Clean the State column to remove leading and trailing whitespace
dfcombined_updated_clean$State &lt;- trimws(dfcombined_updated_clean$State)

# Create a new column named &quot;Region&quot; and assign the region based on state
dfcombined_updated_clean$Region &lt;- ifelse(dfcombined_updated_clean$State %in% midwest, &quot;Midwest&quot;,
                                  ifelse(dfcombined_updated_clean$State %in% northeast, &quot;Northeast&quot;,
                                         ifelse(dfcombined_updated_clean$State %in% south, &quot;South&quot;,
                                                ifelse(dfcombined_updated_clean$State %in% west, &quot;West&quot;, &quot;Unknown&quot;))))


# Calculate summary statistics
ABV &lt;- dfcombined_updated_clean$ABV
mean_ABV &lt;- mean(ABV, na.rm = TRUE)  # Mean
median_ABV &lt;- median(ABV, na.rm = TRUE)  # Median
min_ABV &lt;- min(ABV, na.rm = TRUE)  # Minimum
max_ABV &lt;- max(ABV, na.rm = TRUE)  # Maximum
q1_ABV &lt;- quantile(ABV, probs = 0.25, na.rm = TRUE)  # First quartile (25th percentile)
q3_ABV &lt;- quantile(ABV, probs = 0.75, na.rm = TRUE)  # Third quartile (75th percentile)

# Print summary statistics
cat(&quot;Mean ABV:&quot;, mean_ABV, &quot;\n&quot;)</code></pre>
<pre><code>## Mean ABV: 0.05972379</code></pre>
<pre class="r"><code>cat(&quot;Median ABV:&quot;, median_ABV, &quot;\n&quot;)</code></pre>
<pre><code>## Median ABV: 0.056</code></pre>
<pre class="r"><code>cat(&quot;Minimum ABV:&quot;, min_ABV, &quot;\n&quot;)</code></pre>
<pre><code>## Minimum ABV: 0.027</code></pre>
<pre class="r"><code>cat(&quot;Maximum ABV:&quot;, max_ABV, &quot;\n&quot;)</code></pre>
<pre><code>## Maximum ABV: 0.128</code></pre>
<pre class="r"><code>cat(&quot;First Quartile ABV:&quot;, q1_ABV, &quot;\n&quot;)</code></pre>
<pre><code>## First Quartile ABV: 0.05</code></pre>
<pre class="r"><code>cat(&quot;Third Quartile ABV:&quot;, q3_ABV, &quot;\n&quot;)</code></pre>
<pre><code>## Third Quartile ABV: 0.067</code></pre>
<pre class="r"><code>#distribution
ggplot(dfcombined_updated_clean,aes(x=ABV)) +
  geom_histogram()</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="Beer_MC_files/figure-html/unnamed-chunk-1-3.png" width="960" /></p>
<pre class="r"><code>#using another way
hist(ABV, main = &quot;Distribution of Alcohol By Volume (ABV)&quot;, xlab = &quot;ABV&quot;, ylab = &quot;Frequency&quot;)

# Add summary statistics to the plot
abline(v = mean_ABV, col = &quot;red&quot;, lwd = 2)  # Mean line
abline(v = median_ABV, col = &quot;blue&quot;, lwd = 2)  # Median line
legend(&quot;topright&quot;, legend = c(&quot;Mean&quot;, &quot;Median&quot;), col = c(&quot;red&quot;, &quot;blue&quot;), lwd = 2)</code></pre>
<p><img src="Beer_MC_files/figure-html/unnamed-chunk-1-4.png" width="960" /></p>
<pre class="r"><code>#boxplot
# Box plot with color and labels
ggplot(dfcombined_updated_clean, aes(x = &quot;&quot;, y = ABV, fill = Region)) +
  geom_boxplot() +
  labs(title = &quot;Distribution of Alcohol By Volume (ABV) by Region&quot;, x = NULL, y = &quot;Alcohol By Volume (ABV)&quot;, fill = &quot;Region&quot;)</code></pre>
<p><img src="Beer_MC_files/figure-html/unnamed-chunk-1-5.png" width="960" /></p>
<pre class="r"><code>#summary statement
&quot;The summary statistics for the ABV variable show that the mean alcohol by volume is 5.9%, with a median of 5.7%. The range of ABV values extends from 2.7% to 12.5%, with 5% as the first quartile and 6.8% as the third quartile. The distribution of ABV values appears to be right-skewed, indicating that the majority of beers have lower alcohol content. However, there are some outliers with exceptionally high ABV values, which may represent specialty beers.&quot;</code></pre>
<pre><code>## [1] &quot;The summary statistics for the ABV variable show that the mean alcohol by volume is 5.9%, with a median of 5.7%. The range of ABV values extends from 2.7% to 12.5%, with 5% as the first quartile and 6.8% as the third quartile. The distribution of ABV values appears to be right-skewed, indicating that the majority of beers have lower alcohol content. However, there are some outliers with exceptionally high ABV values, which may represent specialty beers.&quot;</code></pre>
<pre class="r"><code>#question 7 Is there an apparent relationship between the bitterness of the beer and its alcoholic content? Draw a scatter plot

#create a new region column
midwest &lt;- c( &quot;IA&quot;,&quot;IL&quot;, &quot;IN&quot;, &quot;KS&quot;, &quot;MI&quot;, &quot;MN&quot;, &quot;MO&quot;, &quot;ND&quot;,&quot;NE&quot;, &quot;OH&quot;, &quot;SD&quot;, &quot;WI&quot;)
northeast &lt;- c(&quot;CT&quot;,&quot;MA&quot;, &quot;ME&quot;, &quot;NH&quot;, &quot;NJ&quot;, &quot;NY&quot;, &quot;PA&quot;, &quot;RI&quot;, &quot;VT&quot;)
south &lt;- c(&quot;AL&quot;,&quot;AR&quot;,&quot;DC&quot;,&quot;DE&quot;,&quot;FL&quot;,&quot;GA&quot;,&quot;KY&quot;,&quot;LA&quot;,&quot;MD&quot;,&quot;MS&quot;,&quot;NC&quot;,&quot;OK&quot;,&quot;SC&quot;,&quot;TN&quot;,&quot;TX&quot;,&quot;VA&quot;,&quot;WV&quot;)
west &lt;- c(&quot;AK&quot;,&quot;AZ&quot;,&quot;CA&quot;,&quot;CO&quot;,&quot;HI&quot;,&quot;ID&quot;,&quot;MT&quot;,&quot;NM&quot;,&quot;NV&quot;,&quot;OR&quot;,&quot;UT&quot;,&quot;WA&quot;,&quot;WY&quot;)
 
# Clean the State column to remove leading and trailing whitespace
dfcombined_updated_clean$State &lt;- trimws(dfcombined_updated_clean$State)

# Create a new column named &quot;Region&quot; and assign the region based on state
dfcombined_updated_clean$Region &lt;- ifelse(dfcombined_updated_clean$State %in% midwest, &quot;Midwest&quot;,
                                  ifelse(dfcombined_updated_clean$State %in% northeast, &quot;Northeast&quot;,
                                         ifelse(dfcombined_updated_clean$State %in% south, &quot;South&quot;,
                                                ifelse(dfcombined_updated_clean$State %in% west, &quot;West&quot;, &quot;Unknown&quot;))))

# Check the data
unique(dfcombined_updated_clean$Region)</code></pre>
<pre><code>## [1] &quot;Midwest&quot;   &quot;South&quot;     &quot;Northeast&quot; &quot;West&quot;</code></pre>
<pre class="r"><code>head(dfcombined_updated_clean)</code></pre>
<pre><code>##   Brew_ID      BeerName Beer_ID   ABV IBU                               Style
## 1       1  Get Together    2692 0.045  50                        American IPA
## 2       1 Maggie&#39;s Leap    2691 0.049  26                  Milk / Sweet Stout
## 3       1    Wall&#39;s End    2690 0.048  19                   English Brown Ale
## 4       1       Pumpion    2689 0.060  38                         Pumpkin Ale
## 5       1    Stronghold    2688 0.060  25                     American Porter
## 6       1   Parapet ESB    2687 0.056  47 Extra Special / Strong Bitter (ESB)
##   Ounces        BreweryName        City State  Region
## 1     16 NorthGate Brewing  Minneapolis    MN Midwest
## 2     16 NorthGate Brewing  Minneapolis    MN Midwest
## 3     16 NorthGate Brewing  Minneapolis    MN Midwest
## 4     16 NorthGate Brewing  Minneapolis    MN Midwest
## 5     16 NorthGate Brewing  Minneapolis    MN Midwest
## 6     16 NorthGate Brewing  Minneapolis    MN Midwest</code></pre>
<pre class="r"><code>#draw scatterplot
dfcombined_updated_clean %&gt;% select(State,Region,ABV,IBU) %&gt;%
  ggplot(aes(x= ABV, y= IBU,color = Region))+
  geom_point()+labs(title = &quot;Scatterplot of Alcohol by Volume Vs. International Bitterness Unit&quot;, x= &quot;Alcohol by Volume&quot;, y= &quot;International Bitterness Unit&quot;) </code></pre>
<p><img src="Beer_MC_files/figure-html/unnamed-chunk-1-6.png" width="960" /></p>
<pre class="r"><code>#summary statement
&quot;It looks like there is a slight positive association between Alcohol by Volume and International Bitterness Unit. While there is a general tendency for the bitterness to move in the same direction as alcohol by volume, there is also considerable variability around the trend line. Beers from all regions are represented in the variability around the trend line.&quot;</code></pre>
<pre><code>## [1] &quot;It looks like there is a slight positive association between Alcohol by Volume and International Bitterness Unit. While there is a general tendency for the bitterness to move in the same direction as alcohol by volume, there is also considerable variability around the trend line. Beers from all regions are represented in the variability around the trend line.&quot;</code></pre>
<pre class="r"><code>#histogram by region for both IBU and ABV values
ABV &lt;- dfcombined_updated_clean %&gt;%
  select(State, Region, ABV, IBU) %&gt;%
  ggplot(aes(x = ABV, fill = Region)) +
  geom_histogram() +
  labs(title = &quot;Alcohol by Volume by region&quot;) 

IBU &lt;- dfcombined_updated_clean %&gt;%
  select(State, Region, ABV, IBU) %&gt;%
  ggplot(aes(x = IBU, fill = Region)) +
  geom_histogram() +
  labs(title = &quot;IBU by region&quot;) 

library(patchwork)
ABV / IBU</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="Beer_MC_files/figure-html/unnamed-chunk-1-7.png" width="960" /></p>
<pre class="r"><code>#histogram by region for ABV and IBU values in facet wrap style
dfcombined_updated_clean %&gt;%
  select(State, Region, ABV, IBU) %&gt;%
  ggplot(aes(x = ABV, fill = Region)) +
  geom_histogram() +
  labs(title = &quot;Alcohol by Volume by region&quot;) +
  facet_wrap(~Region)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="Beer_MC_files/figure-html/unnamed-chunk-1-8.png" width="960" /></p>
<pre class="r"><code>dfcombined_updated_clean %&gt;%
  select(State, Region, ABV, IBU) %&gt;%
  ggplot(aes(x = IBU, fill = Region)) +
  geom_histogram() +
  labs(title = &quot;IBU by region&quot;) +
  facet_wrap(~Region)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="Beer_MC_files/figure-html/unnamed-chunk-1-9.png" width="960" /></p>
<pre class="r"><code>#question 9 - use knn to explore relationship of ABV &amp; IBU between IPA and other Ales
#creating a data frame with styles of IPA and &quot;ale&quot; in the name
library(dplyr)
library(stringr)

# Filter rows where the Style column contains &quot;IPA&quot; or &quot;Ale&quot;
dfIPA_Ale &lt;- dfcombined_updated_clean %&gt;%
  filter(str_detect(Style, &quot;IPA&quot;) | grepl(&quot;\\bAle\\b&quot;, Style))

# View the filtered data
head(dfIPA_Ale)</code></pre>
<pre><code>##   Brew_ID       BeerName Beer_ID   ABV IBU                          Style
## 1       1   Get Together    2692 0.045  50                   American IPA
## 2       1     Wall&#39;s End    2690 0.048  19              English Brown Ale
## 3       1        Pumpion    2689 0.060  38                    Pumpkin Ale
## 4       2 Citra Ass Down    2686 0.080  68 American Double / Imperial IPA
## 5       2         A Beer    2683 0.042  42        American Pale Ale (APA)
## 6       2  Flesh Gourd&#39;n    2681 0.066  21                    Pumpkin Ale
##   Ounces               BreweryName        City State  Region
## 1     16        NorthGate Brewing  Minneapolis    MN Midwest
## 2     16        NorthGate Brewing  Minneapolis    MN Midwest
## 3     16        NorthGate Brewing  Minneapolis    MN Midwest
## 4     16 Against the Grain Brewery  Louisville    KY   South
## 5     16 Against the Grain Brewery  Louisville    KY   South
## 6     16 Against the Grain Brewery  Louisville    KY   South</code></pre>
<pre class="r"><code>dim(dfIPA_Ale)</code></pre>
<pre><code>## [1] 1533   11</code></pre>
<pre class="r"><code>dim(dfcombined_updated_clean)</code></pre>
<pre><code>## [1] 2358   11</code></pre>
<pre class="r"><code># Add a Type column to differentiate IPA from other Ales
dfIPA_Ale$Type &lt;- ifelse(str_detect(dfIPA_Ale$Style, &quot;IPA&quot;), &quot;IPA&quot;, &quot;Ale&quot;)

#check data
head(dfIPA_Ale)</code></pre>
<pre><code>##   Brew_ID       BeerName Beer_ID   ABV IBU                          Style
## 1       1   Get Together    2692 0.045  50                   American IPA
## 2       1     Wall&#39;s End    2690 0.048  19              English Brown Ale
## 3       1        Pumpion    2689 0.060  38                    Pumpkin Ale
## 4       2 Citra Ass Down    2686 0.080  68 American Double / Imperial IPA
## 5       2         A Beer    2683 0.042  42        American Pale Ale (APA)
## 6       2  Flesh Gourd&#39;n    2681 0.066  21                    Pumpkin Ale
##   Ounces               BreweryName        City State  Region Type
## 1     16        NorthGate Brewing  Minneapolis    MN Midwest  IPA
## 2     16        NorthGate Brewing  Minneapolis    MN Midwest  Ale
## 3     16        NorthGate Brewing  Minneapolis    MN Midwest  Ale
## 4     16 Against the Grain Brewery  Louisville    KY   South  IPA
## 5     16 Against the Grain Brewery  Louisville    KY   South  Ale
## 6     16 Against the Grain Brewery  Louisville    KY   South  Ale</code></pre>
<pre class="r"><code># draw scatterplot
dfIPA_Ale %&gt;%
  select(State, Region, Type, ABV, IBU) %&gt;%
  ggplot(aes(x = ABV, y = IBU, color = Type)) +
  geom_point() +
  labs(
    title = &quot;Scatterplot of Alcohol by Volume Vs. International Bitterness Unit&quot;,
    x = &quot;Alcohol by Volume&quot;,
    y = &quot;International Bitterness Unit&quot;
  )</code></pre>
<p><img src="Beer_MC_files/figure-html/unnamed-chunk-1-10.png" width="960" /></p>
<pre class="r"><code># draw scatterplot by region
dfIPA_Ale %&gt;%
  select(State, Region, Type, ABV, IBU) %&gt;%
  ggplot(aes(x = ABV, y = IBU, color = Type)) +
  geom_point() +
  labs(
    title = &quot;Scatterplot of Alcohol by Volume Vs. International Bitterness Unit&quot;,
    x = &quot;Alcohol by Volume&quot;,
    y = &quot;International Bitterness Unit&quot;
  )+
  facet_wrap(~Region)</code></pre>
<p><img src="Beer_MC_files/figure-html/unnamed-chunk-1-11.png" width="960" /></p>
<pre class="r"><code>#training and test datasets - knn classification
library(class)
library(caret)</code></pre>
<pre><code>## Loading required package: lattice
## 
## Attaching package: &#39;caret&#39;
## 
## The following object is masked from &#39;package:purrr&#39;:
## 
##     lift</code></pre>
<pre class="r"><code>library(e1071)
library(dplyr)

set.seed(6)
splitPerc = .7
trainIndices = sample(1:dim(dfIPA_Ale)[1],round(splitPerc * dim(dfIPA_Ale)[1]))
train = dfIPA_Ale[trainIndices,]
test = dfIPA_Ale[-trainIndices,]
#check data
nrow(train)</code></pre>
<pre><code>## [1] 1073</code></pre>
<pre class="r"><code>nrow(test)</code></pre>
<pre><code>## [1] 460</code></pre>
<pre class="r"><code>nrow(dfIPA_Ale)</code></pre>
<pre><code>## [1] 1533</code></pre>
<pre class="r"><code># k = 5
classifications = knn(train[,c(4,5)],test[,c(4,5)],train$Type, prob = TRUE, k = 7)
table(classifications,test$Type)</code></pre>
<pre><code>##                
## classifications Ale IPA
##             Ale 256  35
##             IPA  22 147</code></pre>
<pre class="r"><code>confusionMatrix(table(classifications,test$Type), mode = &quot;everything&quot;)</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##                
## classifications Ale IPA
##             Ale 256  35
##             IPA  22 147
##                                           
##                Accuracy : 0.8761          
##                  95% CI : (0.8425, 0.9048)
##     No Information Rate : 0.6043          
##     P-Value [Acc &gt; NIR] : &lt;2e-16          
##                                           
##                   Kappa : 0.7377          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.112           
##                                           
##             Sensitivity : 0.9209          
##             Specificity : 0.8077          
##          Pos Pred Value : 0.8797          
##          Neg Pred Value : 0.8698          
##               Precision : 0.8797          
##                  Recall : 0.9209          
##                      F1 : 0.8998          
##              Prevalence : 0.6043          
##          Detection Rate : 0.5565          
##    Detection Prevalence : 0.6326          
##       Balanced Accuracy : 0.8643          
##                                           
##        &#39;Positive&#39; Class : Ale             
## </code></pre>
<pre class="r"><code>#trying naive bayes
#Train a NB model based on the training set using ABV and IBU. 
model = naiveBayes(train[,c(4,5)],train$Type)
#Use the model to predict the Type in the test set and use those results to evaluate the model based on accuracy, sensitivity and specificity. 
table(predict(model,test[,c(4,5)]),test$Type)</code></pre>
<pre><code>##      
##       Ale IPA
##   Ale 243  34
##   IPA  35 148</code></pre>
<pre class="r"><code>confusionMatrix(table(predict(model,test[,c(4,5)]),test$Type), mode = &quot;everything&quot;)</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##      
##       Ale IPA
##   Ale 243  34
##   IPA  35 148
##                                          
##                Accuracy : 0.85           
##                  95% CI : (0.814, 0.8814)
##     No Information Rate : 0.6043         
##     P-Value [Acc &gt; NIR] : &lt;2e-16         
##                                          
##                   Kappa : 0.6866         
##                                          
##  Mcnemar&#39;s Test P-Value : 1              
##                                          
##             Sensitivity : 0.8741         
##             Specificity : 0.8132         
##          Pos Pred Value : 0.8773         
##          Neg Pred Value : 0.8087         
##               Precision : 0.8773         
##                  Recall : 0.8741         
##                      F1 : 0.8757         
##              Prevalence : 0.6043         
##          Detection Rate : 0.5283         
##    Detection Prevalence : 0.6022         
##       Balanced Accuracy : 0.8436         
##                                          
##        &#39;Positive&#39; Class : Ale            
## </code></pre>
<pre class="r"><code>#bonus question - additional insights from the data 
# Load necessary packages
library(ggplot2)
library(dplyr)
library(maps)</code></pre>
<pre><code>## 
## Attaching package: &#39;maps&#39;
## 
## The following object is masked from &#39;package:purrr&#39;:
## 
##     map</code></pre>
<pre class="r"><code># Create a mapping table for state abbreviations to full names
state_mapping &lt;- data.frame(StateAbbrev = c(&quot;AL&quot;, &quot;AK&quot;, &quot;AZ&quot;, &quot;AR&quot;, &quot;CA&quot;, &quot;CO&quot;, &quot;CT&quot;, &quot;DE&quot;, &quot;FL&quot;, &quot;GA&quot;, 
                                            &quot;HI&quot;, &quot;ID&quot;, &quot;IL&quot;, &quot;IN&quot;, &quot;IA&quot;, &quot;KS&quot;, &quot;KY&quot;, &quot;LA&quot;, &quot;ME&quot;, &quot;MD&quot;, 
                                            &quot;MA&quot;, &quot;MI&quot;, &quot;MN&quot;, &quot;MS&quot;, &quot;MO&quot;, &quot;MT&quot;, &quot;NE&quot;, &quot;NV&quot;, &quot;NH&quot;, &quot;NJ&quot;, 
                                            &quot;NM&quot;, &quot;NY&quot;, &quot;NC&quot;, &quot;ND&quot;, &quot;OH&quot;, &quot;OK&quot;, &quot;OR&quot;, &quot;PA&quot;, &quot;RI&quot;, &quot;SC&quot;, 
                                            &quot;SD&quot;, &quot;TN&quot;, &quot;TX&quot;, &quot;UT&quot;, &quot;VT&quot;, &quot;VA&quot;, &quot;WA&quot;, &quot;WV&quot;, &quot;WI&quot;, &quot;WY&quot;),
                           StateFull = c(&quot;alabama&quot;, &quot;alaska&quot;, &quot;arizona&quot;, &quot;arkansas&quot;, &quot;california&quot;, &quot;colorado&quot;, 
                                         &quot;connecticut&quot;, &quot;delaware&quot;, &quot;florida&quot;, &quot;georgia&quot;, &quot;hawaii&quot;, &quot;idaho&quot;, 
                                         &quot;illinois&quot;, &quot;indiana&quot;, &quot;iowa&quot;, &quot;kansas&quot;, &quot;kentucky&quot;, &quot;louisiana&quot;, 
                                         &quot;maine&quot;, &quot;maryland&quot;, &quot;massachusetts&quot;, &quot;michigan&quot;, &quot;minnesota&quot;, 
                                         &quot;mississippi&quot;, &quot;missouri&quot;, &quot;montana&quot;, &quot;nebraska&quot;, &quot;nevada&quot;, 
                                         &quot;new hampshire&quot;, &quot;new jersey&quot;, &quot;new mexico&quot;, &quot;new york&quot;, &quot;north carolina&quot;, 
                                         &quot;north dakota&quot;, &quot;ohio&quot;, &quot;oklahoma&quot;, &quot;oregon&quot;, &quot;pennsylvania&quot;, 
                                         &quot;rhode island&quot;, &quot;south carolina&quot;, &quot;south dakota&quot;, &quot;tennessee&quot;, 
                                         &quot;texas&quot;, &quot;utah&quot;, &quot;vermont&quot;, &quot;virginia&quot;, &quot;washington&quot;, &quot;west virginia&quot;, 
                                         &quot;wisconsin&quot;, &quot;wyoming&quot;))

# Merge the mapping table with your data frame to get full state names
dfcombined_updated_clean &lt;- merge(dfcombined_updated_clean, state_mapping, by.x = &quot;State&quot;, by.y = &quot;StateAbbrev&quot;)

# Aggregate the number of beers available by state
state_beer_data &lt;- dfcombined_updated_clean %&gt;%
  group_by(StateFull) %&gt;%
  summarise(TotalBeersAvailable = n())

# Load US map data
us_map &lt;- map_data(&quot;state&quot;)

# Merge your aggregated data with map data
merged_data &lt;- merge(us_map, state_beer_data, by.x = &quot;region&quot;, by.y = &quot;StateFull&quot;, all.x = TRUE)

# Plot the map
ggplot() +
  geom_map(data = merged_data, map = merged_data,
           aes(x = long, y = lat, map_id = region, fill = TotalBeersAvailable),
           color = &quot;black&quot;, size = 0.15) +
  scale_fill_gradient(low = &quot;lightblue&quot;, high = &quot;darkblue&quot;, na.value = &quot;grey&quot;) + # Adjust color gradient
  labs(title = &quot;Number of beer choices by State&quot;,fill = &quot;Total Beers Available&quot;) +  # Label legend
  coord_fixed(1.3) +  # Adjust aspect ratio
  theme_void()        # Remove axis and grid lines</code></pre>
<pre><code>## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
## ℹ Please use `linewidth` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<pre><code>## Warning in geom_map(data = merged_data, map = merged_data, aes(x = long, :
## Ignoring unknown aesthetics: x and y</code></pre>
<p><img src="Beer_MC_files/figure-html/unnamed-chunk-1-12.png" width="960" /></p>
<pre class="r"><code>#bonus question - most popular ounces
#plot bar
# Aggregate the number of beers available by Ounces
Ounce_data &lt;- dfcombined_updated_clean %&gt;%
  group_by(Ounces) %&gt;%
  summarise(TotalBeersAvailable = n())

# Plot the bar graph
ggplot(Ounce_data, aes(x = Ounces, y = TotalBeersAvailable)) +
  geom_col(show.legend = FALSE, fill = &quot;brown&quot;) +
  labs(title = &quot;Number of beers by ounce packaging&quot;)</code></pre>
<p><img src="Beer_MC_files/figure-html/unnamed-chunk-1-13.png" width="960" /></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
